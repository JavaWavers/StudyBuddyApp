<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SimulateAnnealing.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">studybuddy</a> &gt; <a href="index.source.html" class="el_package">org.javawavers.studybuddy.calculations</a> &gt; <span class="el_source">SimulateAnnealing.java</span></div><h1>SimulateAnnealing.java</h1><pre class="source lang-java linenums">
package org.javawavers.studybuddy.calculations;
/*
 * This class distributes three kinds of tasks (studying -1, repetition -2,
 * assignment -3) into the available days randomly. The algorithm produces 50
 *  valid results,where the tasks are distributed into the available studying
 * hours per day differently (although there are chances for the same results).
 * Then, each result gains a score based on certain criteria, described in the
 * README file. The result with the higher score is considered the final result
 * and is given to the user as a recommended studying schedule.
 */

import java.time.LocalDate;
import java.util.ArrayList;
import java.util.List;
import org.javawavers.studybuddy.courses.Subject;

public class SimulateAnnealing {
    /*
     * The 12 rows represent the maximum tasks that can be assigned to a day,
     * which are 12 tasks of a duration of two hours each. The 8 columns represent
     * the 7 days of the week, starting with Monday. The first column of the table
     * is not used to prevent misinterpretation by the table pointer
     * with a value of zero.
     */

    private static List&lt;Subject&gt; subjects; // List for subjects
    private static List&lt;Task&gt; tasks; // List for each task that is connected with a subject
    private static List&lt;Dates&gt; exams; // List for each exam that is connected with a subject
    private static List&lt;ScheduleResult&gt; scheduleResults;// List for the valid schedule results
    private static List&lt;Dates&gt; assignments;// List for each assignment that is connected with a subject

<span class="nc" id="L33">    public SimulateAnnealing() {</span>
<span class="nc" id="L34">        subjects = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L35">        tasks = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L36">        exams = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L37">        assignments = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L38">        scheduleResults = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L39">    }</span>

    // Add a new Subject
    public void addSubject(Subject subject) {
<span class="nc" id="L43">        subjects.add(subject);</span>
        // Sets exams for the subject
<span class="nc" id="L45">        subExams(subject);</span>
<span class="nc" id="L46">        subAssignment(subject);</span>

        // Creates tasks for the subject
<span class="nc" id="L49">        subTasks(subject);</span>

<span class="nc" id="L51">    }</span>

    // Setting exams for each subject
    private void subExams(Subject subject) {
        // Check if the subject or its exams list is null
<span class="nc bnc" id="L56" title="All 4 branches missed.">        if (subject.getExams() == null || subject.getExams().isEmpty()) {</span>
<span class="nc" id="L57">            throw new IllegalArgumentException(&quot;Subject or exam list is invalid. Exams must not be empty.&quot;);</span>
        }
<span class="nc" id="L59">        Dates examDate = new Dates(subject, subject.getExams().get(0).getExamDate());</span>
<span class="nc" id="L60">        exams.add(examDate);</span>

<span class="nc" id="L62">    }</span>

    // Setting exams for each subject
    private void subAssignment(Subject subject) {
<span class="nc bnc" id="L66" title="All 4 branches missed.">        if (subject.getAssignments() == null || subject.getAssignments().isEmpty()) {</span>
<span class="nc" id="L67">            return; // No assignments, skip further processing</span>
        }
<span class="nc" id="L69">        Dates assDate = new Dates(subject, subject.getAssignments().get(0).getDeadline());</span>
<span class="nc" id="L70">        assignments.add(assDate);</span>

<span class="nc" id="L72">    }</span>

    // Setting assignments for non-subject related assignments
    public void subAss2(String name, LocalDate deadline, int estimateHours) {
        // Create a Dates object with the subject name and the exam date
<span class="nc" id="L77">        Dates assDate = new Dates(name, deadline);</span>
        // Add the Dates object to the list
<span class="nc" id="L79">        assignments.add(assDate);</span>
<span class="nc" id="L80">        subTask2(name, estimateHours);</span>
<span class="nc" id="L81">    }</span>

    // Creating tasks for non-subject related assignments
    private void subTask2(String name, int estimateHours) {
<span class="nc" id="L85">        int taskType3 = CalculativeAlgorithm.numberOfScheduledTask(estimateHours);</span>

        // Task creation for each task type

<span class="nc bnc" id="L89" title="All 2 branches missed.">        for (int i = 0; i &lt; taskType3; i++) {</span>
<span class="nc" id="L90">            tasks.add(new Task(name, 3)); // Assignment</span>
        }
<span class="nc" id="L92">    }</span>

    // Creating tasks for each subject
    private void subTasks(Subject subject) {
<span class="nc bnc" id="L96" title="All 4 branches missed.">        if (subject.getExams() == null || subject.getExams().isEmpty()) {</span>
<span class="nc" id="L97">            throw new IllegalArgumentException(&quot;Cannot create tasks: No exams found for the subject.&quot;);</span>
        }
        // setting the difficulty level

<span class="nc" id="L101">        CalculativeAlgorithm.setPagesPerMin(subject.getExams().get(0).getTimePer20Slides());</span>
        // studying tasks
<span class="nc" id="L103">        int taskType1 = CalculativeAlgorithm.studyingTasks(subject);</span>

        // assignment tasks
<span class="nc" id="L106">        int taskType3 = CalculativeAlgorithm.numberOfScheduledTask(subject.getTotalAssHours());</span>
        // Task creation for each task type
<span class="nc bnc" id="L108" title="All 2 branches missed.">        for (int i = 0; i &lt; taskType1; i++) {</span>
<span class="nc" id="L109">            tasks.add(new Task(subject, 1)); // studying</span>
        }

<span class="nc bnc" id="L112" title="All 2 branches missed.">        for (int i = 0; i &lt; taskType3; i++) {</span>
<span class="nc" id="L113">            tasks.add(new Task(subject, 3)); // Assignment</span>
        }
<span class="nc" id="L115">    }</span>

    // getter for the exam list
    public static List&lt;Dates&gt; getExams() {
<span class="nc" id="L119">        return exams;</span>
    }

    // getter for the assignment list
    public static List&lt;Dates&gt; getAssignments() {
<span class="nc" id="L124">        return assignments;</span>
    }

    private static double bestScoring;
<span class="nc" id="L128">    private static List&lt;Task&gt; bestTask = new ArrayList&lt;&gt;();</span>
    private static int[][] schedule;

    // getters
    public static int[][] getSchedule() {
<span class="nc" id="L133">        return schedule;</span>
    }

    public static List&lt;Task&gt; getBestTask() {
<span class="nc" id="L137">        return bestTask;</span>
    }

<span class="nc" id="L140">    public static List&lt;Subject&gt; getSubjects() {return subjects; }</span>
    // Κατανομή tasks στο πρόγραμμα
    public static void scheduleResult() {
        /*
         * each time the method is called in order to produce the best result
         * the best scoring is set as zero and the list with the best distribution,
         * shuffles an array so that the order of the table elements
         * different from the one that is given
         * The procedure is done 50 times in order to produce 10 possible results
         * Then each list gets a score. The list with the higher score is set as the
         * bestTask
         */
<span class="nc" id="L152">        scheduleResults.clear();</span>
<span class="nc" id="L153">        bestTask.clear();</span>

        // sort exams
<span class="nc" id="L156">        exams = Dates.sortList(exams);</span>
<span class="nc" id="L157">        assignments = Dates.sortList(assignments);</span>
        // The column size of the table is determined by the last examination date
        // The column size of the table is determined by the last examination date
<span class="nc" id="L160">        int colSize = Dates.lastIsDue(exams, assignments);</span>
        List&lt;Task&gt; copyTask;
<span class="nc bnc" id="L162" title="All 2 branches missed.">        for (int i = 0; i &lt; 50; i++) {</span>

<span class="nc" id="L164">            copyTask = new ArrayList&lt;&gt;(tasks);</span>
            double valResultScoring;

<span class="nc" id="L167">            int[][] vSchedule = TaskAssignment.assignTask(copyTask, colSize);</span>

            // list scoring
            // calls static method calculateScore
<span class="nc" id="L171">            valResultScoring = Scoring.calculateScore(TaskAssignment.getTasks(), vSchedule, colSize);</span>
<span class="nc bnc" id="L172" title="All 2 branches missed.">            if (i == 0) {</span>
<span class="nc" id="L173">                bestScoring = valResultScoring;</span>
            }
            // method to assign all the unassigned task type 3
<span class="nc" id="L176">            ScheduleResult result = new ScheduleResult(valResultScoring, TaskAssignment.getTasks(), vSchedule);</span>
<span class="nc" id="L177">            scheduleResults.add(result);</span>

        }
<span class="nc bnc" id="L180" title="All 2 branches missed.">        for (ScheduleResult sr : scheduleResults) {</span>
<span class="nc" id="L181">            bestSchedule(sr.getScore(), sr.getTasks(), sr.getSchedule());</span>
<span class="nc" id="L182">        }</span>
<span class="nc" id="L183">        schedule = Validate.validateSchedule(schedule, bestTask);</span>
<span class="nc" id="L184">         PrintSchedule.printSchedule(schedule, bestTask, colSize);</span>
<span class="nc" id="L185">         CreateWeekDay createWeekDay = new CreateWeekDay();</span>
<span class="nc" id="L186">         createWeekDay.managerWeekDay(schedule, bestTask,colSize);</span>

<span class="nc" id="L188">    }</span>

    public static void bestSchedule(double valResultScoring, List&lt;Task&gt; taskList, int[][] sch) {
        // Update best scoring and schedule only if the new score is equal or better
<span class="nc bnc" id="L192" title="All 2 branches missed.">        if (valResultScoring &gt;= bestScoring) {</span>
<span class="nc" id="L193">            bestScoring = valResultScoring;</span>
            // Create a new list to avoid reference issues
<span class="nc" id="L195">            bestTask = new ArrayList&lt;&gt;(taskList);</span>
<span class="nc" id="L196">            schedule = sch;</span>
        }
<span class="nc" id="L198">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>