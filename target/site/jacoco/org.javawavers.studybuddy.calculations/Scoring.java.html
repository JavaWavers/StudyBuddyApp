<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="el"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Scoring.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">studybuddy</a> &gt; <a href="index.source.html" class="el_package">org.javawavers.studybuddy.calculations</a> &gt; <span class="el_source">Scoring.java</span></div><h1>Scoring.java</h1><pre class="source lang-java linenums">package org.javawavers.studybuddy.calculations;



import java.util.ArrayList;
import java.util.List;
/**  This class is used to assign a score to each valid result
 * that could be used as a recommended study schedule for the user.
 * The SimulateAnnealing class produces 50 valid results.
 * Validity means that the tasks are distributed according to the user's
 * daily availability for studying.
 * Each result is then given a score to determine the most effective one
 * among those that are randomly produced.
 * The maximum score a valid result can achieve is 5.0.
 * -0.2 points are deducted each time the same task type (1-studying,
 * 2-revision, 3-assignment) for the same subject is assigned on the same day.
 * -0.1 points are deducted when the algorithm suggests that the user
 * should study the same subject two days in a row
 */

<span class="nc" id="L21">public class Scoring {</span>
  /**
   * Calculates the total score for a study schedule based on task assignments
   * and subject distribution. The score starts at 5.0 and is reduced based on penalties.
   *
   * @param taskList The list of tasks (study, revision, assignments) in the schedule.
   * @param sch      The 2D schedule array, where each cell contains the index of the task assigned
   *                to that time slot.
   * @param colSize  The number of days in the schedule (number of columns in the schedule array).
   * @return The calculated score of the schedule.
   * @throws IllegalArgumentException If the schedule array or task list is invalid.
   */
  public static double calculateScore(List&lt;Task&gt; taskList, int[][] sch, int colSize) {
<span class="nc bnc" id="L34" title="All 6 branches missed.">    if (taskList == null || sch == null || colSize &lt;= 0) {</span>
<span class="nc" id="L35">      throw new IllegalArgumentException(&quot;Invalid input: taskList, sch,&quot;</span>
              + &quot; or colSize can not be null&quot;);
    }
    // set the score at 5.0. The higher that can possibly be achieved
<span class="nc" id="L39">    double score = 5.0;</span>

    //Deduct penalties for the same task type for the same subject on the same day
<span class="nc" id="L42">    score -= sameDayPenalty(taskList, sch, colSize);</span>

    //Deduct penalties for studying the same subject on consecutive days
<span class="nc" id="L45">    score -= consDaysPenalty(taskList, sch, colSize);</span>

<span class="nc" id="L47">    return score;</span>
  }

  /**
   * Applies a penalty for assigning the same task type (e.g., studying) to the same
   * subject on the same day.
   *
   * @param taskList The list of tasks in the schedule.
   * @param sch      The 2D schedule array.
   * @param colSize  The number of days in the schedule.
   * @return The total penalty for same-day task repetition.
   */
  private static double sameDayPenalty(List&lt;Task&gt; taskList, int[][] sch, int colSize) {
<span class="nc" id="L60">    double penalty = 0.0;</span>
    // creating a list that should contain each subject only once
<span class="nc" id="L62">    List&lt;String&gt; uniqueS = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L63" title="All 2 branches missed.">    for (Task task : taskList) {</span>
<span class="nc" id="L64">      String subject = task.getSubject();</span>
<span class="nc bnc" id="L65" title="All 2 branches missed.">      if (!uniqueS.contains(subject)) {</span>
<span class="nc" id="L66">        uniqueS.add(subject); // Προσθήκη του μαθήματος αν δεν υπάρχει ήδη</span>
      }
<span class="nc" id="L68">    }</span>

    /*
     *-0.2 penalty for the same task type for the same subject on the same day
     * for each day
     */
<span class="nc bnc" id="L74" title="All 2 branches missed.">    for (int col = 0; col &lt; colSize; col++) {</span>

      // for each individual subject
<span class="nc bnc" id="L77" title="All 2 branches missed.">      for (String u : uniqueS) {</span>

        // we check if there is also a same task
<span class="nc bnc" id="L80" title="All 2 branches missed.">        for (int row = 0; row &lt; 12; row++) {</span>
<span class="nc bnc" id="L81" title="All 4 branches missed.">          if (sch[row][col] &gt;= 0 &amp;&amp; sch[row][col] &lt; taskList.size()) {</span>
<span class="nc" id="L82">            Task t = taskList.get(sch[row][col]);</span>
<span class="nc bnc" id="L83" title="All 2 branches missed.">            if (t.getTaskType() == 1) {</span>
              /*
               * checks if the subject from the subject list is the same as
               * the one from the task list
               */
<span class="nc bnc" id="L88" title="All 2 branches missed.">              if (u.equals(t.getSubject())) {</span>
<span class="nc" id="L89">                penalty += 0.2;</span>
              }
            }

          } else {
            break;
          }
        }
<span class="nc" id="L97">      }</span>
    }
<span class="nc" id="L99">    return penalty;</span>
  }

  /**
   * Applies a penalty for scheduling the same subject for studying on consecutive days.
   *
   * @param taskList The list of tasks in the schedule.
   * @param sch      The 2D schedule array.
   * @param colSize  The number of days in the schedule.
   * @return The total penalty for consecutive-day subject repetition.
   */
  private static double consDaysPenalty(List&lt;Task&gt; taskList, int[][] sch, int colSize) {
<span class="nc" id="L111">    double penalty = 0.0;</span>
    // -0.1 penalty for studying the same subject two days in a row
    // For each column (day)
<span class="nc bnc" id="L114" title="All 2 branches missed.">    for (int col = 0; col &lt; colSize - 1; col++) {</span>
      // Traverse the tasks of the current day
<span class="nc bnc" id="L116" title="All 2 branches missed.">      for (int row = 0; row &lt; 12; row++) {</span>
<span class="nc bnc" id="L117" title="All 4 branches missed.">        if (sch[row][col] &gt;= 0 &amp;&amp; sch[row][col] &lt; taskList.size()) {</span>
<span class="nc" id="L118">          Task curTask = taskList.get(sch[row][col]);</span>
<span class="nc" id="L119">          String curSubject = curTask.getSubject();</span>
          // The type of the task (1: Study, 2: Revision, 3: Assignment)
<span class="nc" id="L121">          int curType = curTask.getTaskType();</span>

          // Check the next day
<span class="nc bnc" id="L124" title="All 2 branches missed.">          for (int nextRow = 0; nextRow &lt; 12; nextRow++) {</span>
<span class="nc bnc" id="L125" title="All 4 branches missed.">            if (sch[nextRow][col + 1] != 0 &amp;&amp; sch[nextRow][col + 1] &lt; taskList.size()) {</span>
<span class="nc" id="L126">              Task nextTask = taskList.get(sch[nextRow][col + 1]);</span>
<span class="nc" id="L127">              String nextSubject = nextTask.getSubject();</span>
<span class="nc" id="L128">              int nextType = nextTask.getTaskType();</span>

              // If the same subject and the same type of task is scheduled on consecutive
              // days
              // except from assignments
<span class="nc bnc" id="L133" title="All 6 branches missed.">              if (curSubject.equals(nextSubject) &amp;&amp; curType == nextType &amp;&amp; curType == 1) {</span>
                // Deduct 0.1 points
<span class="nc" id="L135">                penalty += 0.1;</span>
<span class="nc" id="L136">                break;</span>
              }
            }
          }
        }
      }
    }
<span class="nc" id="L143">    return penalty;</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>